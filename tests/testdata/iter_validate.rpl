; config options
server:
	trust-anchor: ". 3600 IN DS 19036 8 2 49AAC11D7B6F6446702E54A1607371607A1A41855200FD2CE1CDDE32F24E8FB5"
	val-override-date: "1436477112"

stub-zone:
	name: "."
	stub-addr: 198.41.0.4 	# a.root-servers.net.
CONFIG_END

SCENARIO_BEGIN Test basic validation of NS cz. (two levels)

; K.ROOT-SERVERS.NET.
RANGE_BEGIN 0 100
	ADDRESS 198.41.0.4
ENTRY_BEGIN
MATCH opcode qtype qname
ADJUST copy_id
REPLY QR AA NOERROR
SECTION QUESTION
. IN NS
SECTION ANSWER
.			518400	IN	NS	a.root-servers.net.
.			518400	IN	NS	b.root-servers.net.
.			518400	IN	NS	c.root-servers.net.
.			518400	IN	NS	d.root-servers.net.
.			518400	IN	NS	e.root-servers.net.
.			518400	IN	NS	f.root-servers.net.
.			518400	IN	NS	g.root-servers.net.
.			518400	IN	NS	h.root-servers.net.
.			518400	IN	NS	i.root-servers.net.
.			518400	IN	NS	j.root-servers.net.
.			518400	IN	NS	k.root-servers.net.
.			518400	IN	NS	l.root-servers.net.
.			518400	IN	NS	m.root-servers.net.
.			518400	IN	RRSIG	NS 8 0 518400 20150719170000 20150709160000 1518 . qoRtgQy1XMDlvBufwjClMyMJRXlcHEl7+Z9mn8BRqZJiAmpYbk+Ku1Z2 omfnUsHX9fLhyLuIRS/FKN4/WPVmcVOxZ09EgZ9hFBH/pn2LOlhQ6abP OIrpy9slr/i9DGZ2YXirKIUWUKUfpcLv0O+g7DZZcqnmhGCikNtXgJ76 njw=
SECTION ADDITIONAL
a.root-servers.net.	518400	IN	A	198.41.0.4
ENTRY_END


ENTRY_BEGIN
MATCH opcode qtype qname
ADJUST copy_id
REPLY QR AA NOERROR
SECTION QUESTION
. IN DNSKEY
SECTION ANSWER
.			172800	IN	DNSKEY	256 3 8 AwEAAZyIkCwEYeG29NV+4cOdKE4DPng/4BqJeoOhKqzJbl+LR33TPWsr wBRfmAi9wvR/Qc6IV4MFMXjmkclXns+atIQZ9uQV3YAvKv/cVuO7Mneu MssIQixaMw+jp73R7zIUNMbLBgJRQXI57Rl+pvXBAkgHndVwv+aJkf7y GEuE9Dtj
.			172800	IN	DNSKEY	256 3 8 AwEAAa67bQck1JjopOOFc+iMISFcp/osWrEst2wbKbuQSUWu77QC9UHL ipiHgWN7JlqVAEjKITZz49hhkLmOpmLK55pTq+RD2kwoyNWk9cvpc+tS nIxT7i93O+3oVeLYjMWrkDAz7K45rObbHDuSBwYZKrcSIUCZnCpNMUtn PFl/04cb
.			172800	IN	DNSKEY	257 3 8 AwEAAagAIKlVZrpC6Ia7gEzahOR+9W29euxhJhVVLOyQbSEW0O8gcCjF FVQUTf6v58fLjwBd0YI0EzrAcQqBGCzh/RStIoO8g0NfnfL2MTJRkxoX bfDaUeVPQuYEhg37NZWAJQ9VnMVDxP/VHL496M/QZxkjf5/Efucp2gaD X6RS6CXpoY68LsvPVjR0ZSwzz1apAzvN9dlzEheX7ICJBBtuA6G3LQpz W5hOA2hzCTMjJPJ8LbqF6dsV6DoBQzgul0sGIcGOYl7OyQdXfZ57relS Qageu+ipAdTTJ25AsRTAoub8ONGcLmqrAmRLKBP1dfwhYB4N7knNnulq QxA+Uk1ihz0=
.			172800	IN	RRSIG	DNSKEY 8 0 172800 20150715235959 20150701000000 19036 . PCLEqe8X433LWIWcrP5jC3Ejjws7XST8CFpiccRKXuB9YGMi3AngOXf4 4wiXG1WXLNb+5Rj/na6/4znyTd3sb21T9syHol9kaVMSXzIGg07yZ0hk 62BVdwKOPphtivSwYYjZYxXXXMR/X1MZNwD6a63Tz2Q+zMnS897CTo3M gMsU8qUUwPAqS52rP82Bf0L3Uhr7KWwfHrfH9CN4kAxi8ha2EWSaHNCo jTHUXnaGDDOtUQUSvrgI8vlBRjncr45ktmUh7a8OF2AxoPlfd/FTp6Dy 1f3B90G8fGml0LU/dQVOr3PWMRmmELhY/QQpL+FptAnxIVPeg7jJsZ9A P3OrmA==
ENTRY_END

ENTRY_BEGIN
MATCH opcode qtype qname
ADJUST copy_id
REPLY QR NOERROR
SECTION QUESTION
cz. IN NS
SECTION AUTHORITY
cz.			172800	IN	NS	a.ns.nic.cz.
cz.			86400	IN	DS	54576 10 2 397E50C85EDE9CDE33F363A9E66FD1B216D788F8DD438A57A423A386 869C8F06
cz.			86400	IN	RRSIG	DS 8 1 86400 20150719170000 20150709160000 1518 . nzjFR1npBJ8enQ4jXm9DZ8S8FheWzMps9xourERlhaal8buDVwyGnWWW wy9z3d+a3hXtYCL+rOJLm9tz+GVRQuZRk6Yp//5ckTGn0HwymIIXw3nU LEfGafsgBIQZiW7eyMq/zwZMjOSQ9KRMomjh1clUxQsuxUrkw/mJMMZI 0R0=
SECTION ADDITIONAL
a.ns.nic.cz.		172800	IN	A	194.0.12.1
ENTRY_END
RANGE_END

; a.ns.nic.cz.
RANGE_BEGIN 0 100
	ADDRESS 194.0.12.1
ENTRY_BEGIN
MATCH opcode qtype qname
ADJUST copy_id
REPLY QR AA NOERROR
SECTION QUESTION
cz. IN NS
SECTION ANSWER
cz.			18000	IN	NS	a.ns.nic.cz.
cz.			18000	IN	NS	b.ns.nic.cz.
cz.			18000	IN	NS	c.ns.nic.cz.
cz.			18000	IN	NS	d.ns.nic.cz.
cz.			18000	IN	RRSIG	NS 10 1 18000 20150722014826 20150708113847 39788 cz. fXbYxeKOypz1mouiC3PTYSUv16rGy93f1GNRwIvNkJQHrDAXImLX6JoS aESL9cm671WJ4d8MgjrCcdaeILyFPnsb2zoSn96sreABtk3zZz54xk23 dzQmXIMSwXDHIpfdF2Adsh+JOblOYuLrgepyG59IRKdPS0UVyDUlIfia slQ=
SECTION ADDITIONAL
a.ns.nic.cz.		18000	IN	A	194.0.12.1
b.ns.nic.cz.		18000	IN	A	194.0.12.1
c.ns.nic.cz.		18000	IN	A	194.0.12.1
d.ns.nic.cz.		18000	IN	A	194.0.12.1
ENTRY_END

RANGE_END

STEP 0 TIME_PASSES ELAPSE 1437004798

STEP 1 QUERY
ENTRY_BEGIN
REPLY RD DO
SECTION QUESTION
cz. IN NS
ENTRY_END

; recursion happens here.
STEP 10 CHECK_ANSWER
ENTRY_BEGIN
MATCH all
REPLY QR RD RA AD NOERROR
SECTION QUESTION
cz. IN NS
SECTION ANSWER
cz.			18000	IN	NS	a.ns.nic.cz.
cz.			18000	IN	NS	b.ns.nic.cz.
cz.			18000	IN	NS	c.ns.nic.cz.
cz.			18000	IN	NS	d.ns.nic.cz.
cz.			18000	IN	RRSIG	NS 10 1 18000 20150722014826 20150708113847 39788 cz. fXbYxeKOypz1mouiC3PTYSUv16rGy93f1GNRwIvNkJQHrDAXImLX6JoS aESL9cm671WJ4d8MgjrCcdaeILyFPnsb2zoSn96sreABtk3zZz54xk23 dzQmXIMSwXDHIpfdF2Adsh+JOblOYuLrgepyG59IRKdPS0UVyDUlIfia slQ=
ENTRY_END

SCENARIO_END
